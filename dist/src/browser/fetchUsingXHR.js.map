{
  "version": 3,
  "sources": [
    "../../../src/browser/fetchUsingXHR.js"
  ],
  "names": [
    "getHeadersFromXHR",
    "xhr",
    "headersString",
    "getAllResponseHeaders",
    "lines",
    "trim",
    "split",
    "headerMap",
    "forEach",
    "line",
    "parts",
    "name",
    "shift",
    "value",
    "join",
    "normalizeXhr",
    "status",
    "reason",
    "statusText",
    "headers",
    "body",
    "responseText",
    "fetchUsingXHR",
    "url",
    "Promise",
    "resolve",
    "reject",
    "XMLHttpRequest",
    "ontimeout",
    "onerror",
    "error",
    "onload",
    "onreadystatechange",
    "readyState",
    "open",
    "send"
  ],
  "mappings": ";;;;;;;;;;;AAAA;AACA,MAAMA,iBAAiB,GAAIC,GAAD,IAAS;AACjC,QAAMC,aAAa,GAAGD,GAAG,CAACE,qBAAJ,EAAtB;;AACA,MAAID,aAAa,KAAK,EAAtB,EAA0B;AACxB,WAAO,EAAP;AACD;;AAED,QAAME,KAAK,GAAGF,aAAa,CAACG,IAAd,GAAqBC,KAArB,CAA2B,SAA3B,CAAd;AAEA,QAAMC,SAAS,GAAG,EAAlB;AACAH,EAAAA,KAAK,CAACI,OAAN,CAAeC,IAAD,IAAU;AACtB,UAAMC,KAAK,GAAGD,IAAI,CAACH,KAAL,CAAW,IAAX,CAAd;AACA,UAAMK,IAAI,GAAGD,KAAK,CAACE,KAAN,EAAb;AACA,UAAMC,KAAK,GAAGH,KAAK,CAACI,IAAN,CAAW,IAAX,CAAd;AACAP,IAAAA,SAAS,CAACI,IAAD,CAAT,GAAkBE,KAAlB;AACD,GALD;AAOA,SAAON,SAAP;AACD,CAjBD;;AAmBA,MAAMQ,YAAY,GAAId,GAAD,IAAS;AAC5B,SAAO;AACLe,IAAAA,MAAM,EAAEf,GAAG,CAACe,MADP;AAELC,IAAAA,MAAM,EAAEhB,GAAG,CAACiB,UAFP;AAGLC,IAAAA,OAAO,EAAEnB,iBAAiB,CAACC,GAAD,CAHrB;AAILmB,IAAAA,IAAI,EAAEnB,GAAG,CAACoB;AAJL,GAAP;AAMD,CAPD;;AASO,MAAMC,aAAa,GAAIC,GAAD,IAAS;AACpC,SAAO,IAAIC,OAAJ,CAAY,CAACC,OAAD,EAAUC,MAAV,KAAqB;AACtC,UAAMzB,GAAG,GAAG,IAAI0B,cAAJ,EAAZ;;AAEA1B,IAAAA,GAAG,CAAC2B,SAAJ,GAAgB,MAAM;AACpBF,MAAAA,MAAM,CAAC;AACLf,QAAAA,IAAI,EAAE;AADD,OAAD,CAAN;AAGD,KAJD;;AAMAV,IAAAA,GAAG,CAAC4B,OAAJ,GAAeC,KAAD,IAAW;AACvBJ,MAAAA,MAAM,CAACI,KAAD,CAAN;AACD,KAFD;;AAIA7B,IAAAA,GAAG,CAAC8B,MAAJ,GAAa,MAAM;AACjB,UAAI9B,GAAG,CAACe,MAAJ,KAAe,CAAnB,EAAsB;AACpBS,QAAAA,OAAO,mBACFV,YAAY,CAACd,GAAD,CADV;AAELe,UAAAA,MAAM,EAAE;AAFH,WAAP;AAKA;AACD;;AACDS,MAAAA,OAAO,mBACFV,YAAY,CAACd,GAAD,CADV,EAAP;AAGD,KAZD;;AAcAA,IAAAA,GAAG,CAAC+B,kBAAJ,GAAyB,MAAM;AAC7B,UAAI/B,GAAG,CAACgC,UAAJ,KAAmB,CAAvB,EAA0B;AACxB;AACD,OAH4B,CAK7B;;;AACA,UAAIhC,GAAG,CAACe,MAAJ,KAAe,CAAnB,EAAsB;AACpB,YAAIf,GAAG,CAACoB,YAAR,EAAsB;AACpBpB,UAAAA,GAAG,CAAC8B,MAAJ;AACD;;AACD;AACD;;AAEDN,MAAAA,OAAO,CAACV,YAAY,CAACd,GAAD,CAAb,CAAP;AACD,KAdD;;AAgBAA,IAAAA,GAAG,CAACiC,IAAJ,CAAS,KAAT,EAAgBX,GAAhB,EAAqB,IAArB;AACAtB,IAAAA,GAAG,CAACkC,IAAJ,CAAS,IAAT;AACD,GA7CM,CAAP;AA8CD,CA/CM",
  "sourcesContent": [
    "// https://developer.mozilla.org/en-US/docs/Web/API/XMLHttpRequest/getAllResponseHeaders#Example\nconst getHeadersFromXHR = (xhr) => {\n  const headersString = xhr.getAllResponseHeaders()\n  if (headersString === \"\") {\n    return {}\n  }\n\n  const lines = headersString.trim().split(/[\\r\\n]+/)\n\n  const headerMap = {}\n  lines.forEach((line) => {\n    const parts = line.split(\": \")\n    const name = parts.shift()\n    const value = parts.join(\": \")\n    headerMap[name] = value\n  })\n\n  return headerMap\n}\n\nconst normalizeXhr = (xhr) => {\n  return {\n    status: xhr.status,\n    reason: xhr.statusText,\n    headers: getHeadersFromXHR(xhr),\n    body: xhr.responseText,\n  }\n}\n\nexport const fetchUsingXHR = (url) => {\n  return new Promise((resolve, reject) => {\n    const xhr = new XMLHttpRequest()\n\n    xhr.ontimeout = () => {\n      reject({\n        name: \"REQUEST_TIMEOUT_ERROR\",\n      })\n    }\n\n    xhr.onerror = (error) => {\n      reject(error)\n    }\n\n    xhr.onload = () => {\n      if (xhr.status === 0) {\n        resolve({\n          ...normalizeXhr(xhr),\n          status: 200,\n        })\n\n        return\n      }\n      resolve({\n        ...normalizeXhr(xhr),\n      })\n    }\n\n    xhr.onreadystatechange = () => {\n      if (xhr.readyState !== 4) {\n        return\n      }\n\n      // in Chrome on file:/// URLs, status is 0\n      if (xhr.status === 0) {\n        if (xhr.responseText) {\n          xhr.onload()\n        }\n        return\n      }\n\n      resolve(normalizeXhr(xhr))\n    }\n\n    xhr.open(\"GET\", url, true)\n    xhr.send(null)\n  })\n}\n"
  ]
}